---
import { Language } from "@anglish/core";
import { getTotalPages } from "@anglish/db";
import { LETTER_ENTRIES_PER_PAGE } from "~/constants";

const { letter, lang, page } = Astro.props as { letter: string; lang?: Language; page?: string };
const pageNumber = Number(page ?? 1);
const totalPages = await getTotalPages(letter, LETTER_ENTRIES_PER_PAGE, lang);
---

<section class="py-12">
  <nav class="flex items-center justify-center gap-6 h-nav">
  {Array.from({ length: totalPages }).map((_, index) => {
    const langPart = lang && (lang === Language.Anglish ? "/anglish" : "/english");
    const href = `/letter/${letter}${langPart ?? ""}${index ? `/${index + 1}` : ""}`;
    return (
    <a
      href={href}
      class:list={[
      "h-full flex items-center justify-center text-sm text-gray-500 hover:text-gray-700 rounded aspect-square",
      index + 1 === pageNumber ? "bg-gray-300 font-bold" : "bg-gray-200",
    ]}
    >
      {index + 1}
    </a>
  );
  })}
  </nav>
</section>
